
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   <!--
This HTML was auto-generated from MATLAB code.
To make changes, update the MATLAB code and republish this document.
      --><title>Demonstration of Feature Selection Functions</title><meta name="generator" content="MATLAB 9.9"><link rel="schema.DC" href="http://purl.org/dc/elements/1.1/"><meta name="DC.date" content="2021-07-27"><meta name="DC.source" content="demo_script2.m"><style type="text/css">
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{margin:0;padding:0;border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent}body{line-height:1}ol,ul{list-style:none}blockquote,q{quotes:none}blockquote:before,blockquote:after,q:before,q:after{content:'';content:none}:focus{outine:0}ins{text-decoration:none}del{text-decoration:line-through}table{border-collapse:collapse;border-spacing:0}

html { min-height:100%; margin-bottom:1px; }
html body { height:100%; margin:0px; font-family:Arial, Helvetica, sans-serif; font-size:10px; color:#000; line-height:140%; background:#fff none; overflow-y:scroll; }
html body td { vertical-align:top; text-align:left; }

h1 { padding:0px; margin:0px 0px 25px; font-family:Arial, Helvetica, sans-serif; font-size:1.5em; color:#d55000; line-height:100%; font-weight:normal; }
h2 { padding:0px; margin:0px 0px 8px; font-family:Arial, Helvetica, sans-serif; font-size:1.2em; color:#000; font-weight:bold; line-height:140%; border-bottom:1px solid #d6d4d4; display:block; }
h3 { padding:0px; margin:0px 0px 5px; font-family:Arial, Helvetica, sans-serif; font-size:1.1em; color:#000; font-weight:bold; line-height:140%; }

a { color:#005fce; text-decoration:none; }
a:hover { color:#005fce; text-decoration:underline; }
a:visited { color:#004aa0; text-decoration:none; }

p { padding:0px; margin:0px 0px 20px; }
img { padding:0px; margin:0px 0px 20px; border:none; }
p img, pre img, tt img, li img, h1 img, h2 img { margin-bottom:0px; }

ul { padding:0px; margin:0px 0px 20px 23px; list-style:square; }
ul li { padding:0px; margin:0px 0px 7px 0px; }
ul li ul { padding:5px 0px 0px; margin:0px 0px 7px 23px; }
ul li ol li { list-style:decimal; }
ol { padding:0px; margin:0px 0px 20px 0px; list-style:decimal; }
ol li { padding:0px; margin:0px 0px 7px 23px; list-style-type:decimal; }
ol li ol { padding:5px 0px 0px; margin:0px 0px 7px 0px; }
ol li ol li { list-style-type:lower-alpha; }
ol li ul { padding-top:7px; }
ol li ul li { list-style:square; }

.content { font-size:1.2em; line-height:140%; padding: 20px; }

pre, code { font-size:12px; }
tt { font-size: 1.2em; }
pre { margin:0px 0px 20px; }
pre.codeinput { padding:10px; border:1px solid #d3d3d3; background:#f7f7f7; }
pre.codeoutput { padding:10px 11px; margin:0px 0px 20px; color:#4c4c4c; }
pre.error { color:red; }

@media print { pre.codeinput, pre.codeoutput { word-wrap:break-word; width:100%; } }

span.keyword { color:#0000FF }
span.comment { color:#228B22 }
span.string { color:#A020F0 }
span.untermstring { color:#B20000 }
span.syscmd { color:#B28C00 }
span.typesection { color:#A0522D }

.footer { width:auto; padding:10px 0px; margin:25px 0px 0px; border-top:1px dotted #878787; font-size:0.8em; line-height:140%; font-style:italic; color:#878787; text-align:left; float:none; }
.footer p { margin:0px; }
.footer a { color:#878787; }
.footer a:hover { color:#878787; text-decoration:underline; }
.footer a:visited { color:#878787; }

table th { padding:7px 5px; text-align:left; vertical-align:middle; border: 1px solid #d6d4d4; font-weight:bold; }
table td { padding:7px 5px; text-align:left; vertical-align:top; border:1px solid #d6d4d4; }





  </style></head><body><div class="content"><h1>Demonstration of Feature Selection Functions</h1><!--introduction--><!--/introduction--><h2>Contents</h2><div><ul><li><a href="#1">HVG analysis with single data X</a></li><li><a href="#3">Spline-fit feature selection with single data X</a></li><li><a href="#5">Analysis of differentially deviated (DD) genes using spline-fit feature selection with data X and Y</a></li><li><a href="#7">Using function SC_SPLINEFIT2 to fit X and Y separately and obtain DD</a></li><li><a href="#8">Top 50 genes with highest DD value.</a></li><li><a href="#9">The End</a></li></ul></div><h2 id="1">HVG analysis with single data X</h2><pre class="codeinput">cdgea; <span class="comment">% set working directory</span>
[X,genelist]=sc_readfile(<span class="string">'example_data/GSM3044891_GeneExp.UMIs.10X1.txt'</span>);
[X,genelist]=sc_selectg(X,genelist,3,1);
<span class="comment">% Normalize data with DESeq method</span>
Xn=sc_norm(X,<span class="string">'type'</span>,<span class="string">'deseq'</span>);
[T]=sc_hvg(Xn,genelist,true,true);

<span class="comment">% Highly variable genes (HVGenes), FDR&lt;0.05</span>
HVGenes=T.genes(T.fdr&lt;0.05)
</pre><pre class="codeoutput">Reading example_data/GSM3044891_GeneExp.UMIs.10X1.txt ...... done.

HVGenes = 

  861&times;1 string array

    "IGHG1"
    "IGHG3"
    "IGKC"
    "IGHG4"
    "IGKV1-12"
    "WFDC2"
    "CCL22"
    "IGHM"
    "CCL4"
    "CCL3L3"
    "IFI27"
    "FXYD2"
    "FXYD6-FXYD2"
    "KCNMA1"
    "CCL4L2"
    "CKB"
    "IGLC3"
    "PRKCDBP"
    "RGS1"
    "CXCL10"
    "UBD"
    "SFN"
    "CCL3"
    "CXCL8"
    "IGHV1-24"
    "NFATC1"
    "CCL17"
    "HSPA1B"
    "C10orf10"
    "PEG10"
    "RARRES2"
    "MIR3142HG"
    "TVP23A"
    "HIST2H2AA3"
    "IL32"
    "LTA"
    "MAL"
    "SGK1"
    "IER3"
    "CYP1B1"
    "BRD3"
    "HIST1H2BJ"
    "MIR155HG"
    "CCR7"
    "TNFRSF18"
    "HIST1H2BC"
    "SOX4"
    "FSCN1"
    "TUBB2B"
    "CD9"
    "FCER1G"
    "ATP1B1"
    "PDLIM4"
    "HIST1H1C"
    "BIN1"
    "AC092580.4"
    "RGS2"
    "IGLV6-57"
    "TNFAIP2"
    "LTB"
    "TNFSF4"
    "TMPRSS3"
    "LMNA"
    "CD69"
    "SSTR2"
    "TUBB2A"
    "RSPH1"
    "DUSP2"
    "NFKBIA"
    "LINC00176"
    "CD83"
    "RGS16"
    "RP5-887A10.1"
    "CRIP1"
    "FAM43A"
    "CSF1"
    "MIER2"
    "OSTN-AS1"
    "RP11-856M7.6"
    "DUSP4"
    "IGHD"
    "CETP"
    "JCHAIN"
    "GNG8"
    "AICDA"
    "IL4I1"
    "HIST1H2AC"
    "PTP4A3"
    "UNKL"
    "TPRG1"
    "S100A4"
    "MACROD2"
    "HMOX1"
    "MYC"
    "TNFRSF4"
    "UBE2C"
    "IGKV4-1"
    "ID2"
    "CREB3L1"
    "ATF3"
    "MT2A"
    "EBI3"
    "SOCS3"
    "HIST1H4C"
    "LARP6"
    "TPM2"
    "MARCKSL1"
    "IGHV3-23"
    "FSTL3"
    "IGLC7"
    "TXNIP"
    "BIRC3"
    "DHRS9"
    "PLA2G16"
    "RASGRP2"
    "CTSC"
    "KRT7"
    "CHI3L2"
    "ID3"
    "PASK"
    "VPREB3"
    "LAMP5"
    "PIF1"
    "ASB2"
    "TNF"
    "IL2RA"
    "GNG11"
    "CCL5"
    "CD24"
    "TIGIT"
    "TOP2A"
    "IL10"
    "OASL"
    "HIST1H1D"
    "CDKN1A"
    "EMX1"
    "RHOV"
    "HMX2"
    "LGMN"
    "RASSF4"
    "BCL2A1"
    "JUN"
    "TNFAIP3"
    "H1FX"
    "RASSF6"
    "SRGN"
    "ANKRD37"
    "AQP3"
    "HSPB1"
    "FEZ1"
    "TRAF1"
    "CTC-425F1.4"
    "DMKN"
    "CDC20"
    "CENPA"
    "CCNB1"
    "EGR2"
    "RRM2"
    "TESC"
    "MT1E"
    "GPR183"
    "PLK1"
    "HIST1H4H"
    "TRIB3"
    "LINC00158"
    "PLD4"
    "RP11-294C11.4"
    "MKNK2"
    "LINC01480"
    "IGHA1"
    "VIM"
    "AURKA"
    "PLCG2"
    "SNX9"
    "SERPINB1"
    "BCL2L11"
    "HRASLS2"
    "SOCS1"
    "IGHA2"
    "ABCB9"
    "CCDC74A"
    "JUNB"
    "LMO2"
    "BHLHE40"
    "CYS1"
    "CENPF"
    "CITED2"
    "IFIT3"
    "HIST1H2AI"
    "PHGDH"
    "NCF2"
    "HIST1H1B"
    "LINC01588"
    "TCL1A"
    "FAM92B"
    "EVI2A"
    "NCALD"
    "CD40"
    "IGLC2"
    "PTAFR"
    "DERL3"
    "TUBA8"
    "CAPG"
    "HIST1H3D"
    "UBE2S"
    "LILRB4"
    "AC079767.4"
    "SPARC"
    "KPNA2"
    "MKI67"
    "TUBA1A"
    "CAPN10-AS1"
    "HIST1H2AE"
    "CD44"
    "MYL9"
    "GLUL"
    "ACY3"
    "CD22"
    "SELL"
    "FRMD4A"
    "RP11-295G20.2"
    "HIST1H2BG"
    "GADD45A"
    "HNF1B"
    "LDLRAD4"
    "OGFOD2"
    "HIST1H1E"
    "SERPINB9"
    "MID1IP1"
    "NUSAP1"
    "CDK1"
    "SEPT10"
    "S100A6"
    "BATF3"
    "RAB38"
    "FAM111B"
    "UNQ6494"
    "BCL2L1"
    "S100A11"
    "ASPM"
    "ICAM1"
    "HMGB2"
    "KLF2"
    "TSC22D3"
    "SMIM14"
    "ETV7"
    "PCNA"
    "HMMR"
    "DNASE1L3"
    "SDC1"
    "TRBC2"
    "C16orf54"
    "NTRK2"
    "HIST1H3G"
    "ABCB10"
    "IGLL5"
    "BATF"
    "SIRPA"
    "KIF3A"
    "ITM2A"
    "PIM1"
    "CCNB2"
    "LGALS14"
    "CD82"
    "IFI30"
    "MFSD2A"
    "TIMP1"
    "TUBA1B"
    "ABCG1"
    "IL18R1"
    "S1PR4"
    "SHF"
    "DDIT4"
    "BBC3"
    "DDIT3"
    "AC074289.1"
    "CHAC1"
    "PIM3"
    "LRRK2"
    "GNA15"
    "COCH"
    "CCR1"
    "GBP2"
    "RP1-34B20.21"
    "INSIG1"
    "MGST1"
    "CENPE"
    "E2F8"
    "NINJ1"
    "LGALS3"
    "TPX2"
    "A4GALT"
    "RGCC"
    "ALOX5AP"
    "SOX9"
    "TIMD4"
    "SAP130"
    "CMPK2"
    "ZFP36L1"
    "HIST2H2AC"
    "TNFSF10"
    "CCDC28B"
    "WDR91"
    "CD300A"
    "XBP1"
    "NFKBIE"
    "GTSE1"
    "GMNN"
    "SLC3A2"
    "MYB"
    "NFKBID"
    "BNIP3"
    "BASP1"
    "AURKB"
    "TRIP10"
    "HSPA5"
    "TBC1D30"
    "PTGIR"
    "MEOX1"
    "TTC39C-AS1"
    "PLAC8"
    "CCR6"
    "PSAT1"
    "IPCEF1"
    "ICA1L"
    "NQO1"
    "HCK"
    "PIM2"
    "PHLDA3"
    "NAALADL2-AS2"
    "CSF2RB"
    "ALDOC"
    "MIR4435-2HG"
    "CCND2"
    "DLGAP5"
    "ATF5"
    "IFIT2"
    "C2orf88"
    "CD226"
    "RNASE6"
    "LST1"
    "AHNAK"
    "FCRL5"
    "GALM"
    "GBP4"
    "CAMP"
    "FAM101B"
    "MARCKS"
    "MTG2"
    "DNAJB9"
    "SCD"
    "FUCA1"
    "APOBEC3A"
    "PRRG4"
    "AK4"
    "TYMS"
    "KCNK6"
    "CLSPN"
    "CCNA2"
    "SMIM3"
    "FAM72D"
    "ZMAT3"
    "F12"
    "SNHG12"
    "TRAF4"
    "TNFSF13B"
    "CTH"
    "RP11-554E23.2"
    "C1orf228"
    "FABP5"
    "HLA-DQB1"
    "CAV1"
    "APOL1"
    "CD180"
    "ING5"
    "RP3-428L16.2"
    "H2BFS"
    "ZFP36L2"
    "TLCD1"
    "IGF1"
    "CKS1B"
    "RP11-693J15.5"
    "RP11-81H14.2"
    "NUF2"
    "IFIT1"
    "PFN2"
    "STAT5A"
    "CDCA2"
    "TCF7"
    "TK1"
    "SPC25"
    "PLEK"
    "GIMAP7"
    "ASRGL1"
    "ING1"
    "SORBS2"
    "NCR3"
    "AC007192.4"
    "P3H2"
    "SELM"
    "GINS2"
    "PLIN2"
    "LRRC75A"
    "B3GNT7"
    "SPIB"
    "BIRC5"
    "ASF1B"
    "CAV2"
    "CLIC2"
    "GPR155"
    "KLK1"
    "UPP1"
    "SEL1L3"
    "CDCA8"
    "IGLV2-23"
    "FNIP2"
    "BLOC1S5-TXNDC5"
    "SAMSN1"
    "LAG3"
    "ZBTB32"
    "RP11-1070N10.3"
    "MYO1F"
    "CHPF"
    "TUBA1C"
    "FAM46C"
    "HLA-DQA1"
    "CKS2"
    "H2AFX"
    "FAM83D"
    "GPR82"
    "LDHA"
    "CDCA3"
    "CARS2"
    "IGF2BP3"
    "NAAA"
    "FADS3"
    "HJURP"
    "ZNF605"
    "SYNPO"
    "IFNG-AS1"
    "CDKN2D"
    "CASP1"
    "TAGAP"
    "IGLC6"
    "ESCO2"
    "DUSP11"
    "TUBB4B"
    "DAPK2"
    "BCAT1"
    "STAC3"
    "FAS"
    "FBXO5"
    "PRC1"
    "PRDM1"
    "GBE1"
    "P2RX5"
    "LBH"
    "BFSP2"
    "ZWINT"
    "SLAMF1"
    "HMGCS1"
    "TMEM45A"
    "GIMAP5"
    "RCN1"
    "RAB13"
    "INPP5F"
    "SESN2"
    "BIK"
    "RASA3"
    "HIST3H2A"
    "ZFP36"
    "F2RL3"
    "E2F2"
    "SULF2"
    "PLEKHF1"
    "GRAP2"
    "HERPUD1"
    "CCDC74B"
    "CD84"
    "PDGFA"
    "IRF8"
    "GATA3"
    "UNC119"
    "KDM6B"
    "CTA-293F17.1"
    "HIST2H4B"
    "SLC5A3"
    "CR2"
    "CD274"
    "INSR"
    "ABCA6"
    "GADD45B"
    "RP11-670E13.6"
    "CCL25"
    "CXCR3"
    "SYNGR1"
    "RAB31"
    "DUSP5"
    "SYTL1"
    "NKG7"
    "HIC1"
    "IL3RA"
    "RP11-138A9.2"
    "PILRA"
    "LAX1"
    "FKBP4"
    "STMN1"
    "BEX5"
    "CCNE2"
    "SNN"
    "HAPLN3"
    "E2F1"
    "BTG2"
    "FEN1"
    "CD200"
    "NDC80"
    "ADGRE1"
    "TEX9"
    "SLCO5A1"
    "MS4A1"
    "LINC00926"
    "PLK3"
    "CDKN3"
    "PEA15"
    "NEK2"
    "KIF14"
    "C4orf32"
    "KLF6"
    "MS4A7"
    "CTA-384D8.34"
    "SORD"
    "CD38"
    "SLC7A11"
    "CD86"
    "ZBP1"
    "TUBB"
    "UNG"
    "C1orf186"
    "GLT1D1"
    "ARHGAP11A"
    "STAG3"
    "NFKB2"
    "RNF103"
    "SGOL2"
    "CCNE1"
    "LGALS1"
    "MOXD1"
    "EMID1"
    "WNT10A"
    "BCL7A"
    "TP53INP1"
    "MIR3681HG"
    "REL"
    "CDT1"
    "CCNF"
    "P4HA1"
    "TRIB2"
    "IGLC5"
    "HIST1H2BD"
    "TNFSF9"
    "SH3TC1"
    "NOL3"
    "FAM65B"
    "NME4"
    "SLC43A3"
    "TRIB1"
    "NAPSA"
    "CD80"
    "ERC1"
    "MAP3K8"
    "CDCA5"
    "DEPDC1"
    "ITGB2-AS1"
    "MIAT"
    "CTDP1"
    "C12orf77"
    "LINC01307"
    "ACAT2"
    "CLDN14"
    "HIST1H2AM"
    "FSD1L"
    "BCAR3"
    "EPHX2"
    "CEP55"
    "KIF2C"
    "IZUMO4"
    "HLA-DMB"
    "RALGPS2"
    "RORA"
    "TSPAN12"
    "UCHL1"
    "MACC1"
    "TROAP"
    "ACTA2"
    "TTC39C"
    "TFRC"
    "PKMYT1"
    "KIFC1"
    "TNFSF11"
    "SLC16A3"
    "IL6R"
    "CDCA7"
    "LYPD6B"
    "ASNS"
    "KIFAP3"
    "HIST1H2AH"
    "HILPDA"
    "MYO6"
    "FAM72C"
    "LYAR"
    "FAM72B"
    "SCIMP"
    "MNDA"
    "LCK"
    "GAS7"
    "MGLL"
    "UBE2T"
    "ENC1"
    "ARL4C"
    "C17orf96"
    "PPP1R15A"
    "CLNK"
    "CA2"
    "PITPNC1"
    "HELLS"
    "CRNDE"
    "RP11-693J15.4"
    "PTMS"
    "DTL"
    "LAMP3"
    "RNGTT"
    "CRYZ"
    "GRHPR"
    "SGOL1"
    "HPDL"
    "SORL1"
    "MCM7"
    "DUSP10"
    "BCL11A"
    "PHF19"
    "KCNK1"
    "CDC45"
    "BUB1"
    "CAPN2"
    "ECE1"
    "S100A13"
    "TLR1"
    "TMEM140"
    "NFKBIZ"
    "METTL7A"
    "SAT1"
    "MT1X"
    "CECR1"
    "HGSNAT"
    "KIAA0101"
    "TMOD1"
    "LIPH"
    "SNX22"
    "MCM6"
    "CD72"
    "IL4R"
    "GIMAP6"
    "DEK"
    "EXD3"
    "CD68"
    "CD79A"
    "UHRF1"
    "FAM64A"
    "ACTN1"
    "KLF3"
    "BMP2K"
    "APOL2"
    "HIST1H2BK"
    "PDLIM2"
    "RARG"
    "TBC1D9"
    "CFAP57"
    "KCP"
    "ADA"
    "ZNF608"
    "PCGF2"
    "PBK"
    "KCNMB2"
    "FAM102A"
    "WDR60"
    "CENPU"
    "GBP1"
    "PKIG"
    "MAP3K7CL"
    "ALDH2"
    "LTBP3"
    "ACP5"
    "CDCA4"
    "NCAPG"
    "CMBL"
    "CENPV"
    "MIR22HG"
    "B4GALT1"
    "MMD"
    "ATAD2"
    "SMAD1"
    "IL2RB"
    "CTB-58E17.1"
    "PMAIP1"
    "RP11-131L23.1"
    "PAQR4"
    "PRR11"
    "MSH5"
    "DENND3"
    "GABARAPL1"
    "CTNNAL1"
    "CTA-29F11.1"
    "DDAH2"
    "CKAP2L"
    "TAF4"
    "AHR"
    "CHAF1A"
    "FDXR"
    "RP3-325F22.5"
    "SMAD4"
    "MSMO1"
    "SMC4"
    "FAM129C"
    "MZB1"
    "MCM10"
    "TNFSF14"
    "GFI1"
    "BNIP3L"
    "LACTB"
    "VDR"
    "HSBP1L1"
    "ORC6"
    "CTD-2020K17.1"
    "DIAPH3"
    "PSMC3IP"
    "DDB2"
    "SLC43A2"
    "HIST1H3H"
    "SYTL3"
    "RARRES3"
    "SPC24"
    "CDC6"
    "WDR76"
    "ESR2"
    "SLC15A3"
    "NAB2"
    "TCN2"
    "TACC3"
    "KIF11"
    "PARM1"
    "KCNN4"
    "VASH2"
    "KIF20B"
    "DMD"
    "TBX21"
    "HOXB2"
    "FBRSL1"
    "SLBP"
    "CSRNP1"
    "LRMP"
    "MYLIP"
    "PTTG1"
    "MCM3"
    "BAIAP2L1"
    "EXO1"
    "ACSS2"
    "TBCD"
    "CPNE5"
    "ICA1"
    "ABLIM1"
    "SUSD1"
    "IFIH1"
    "MIR181A1HG"
    "ERN1"
    "KIF23"
    "NADK2"
    "PTPRE"
    "FOXM1"
    "HAGHL"
    "FCER2"
    "HSPE1"
    "KIF20A"
    "MBOAT2"
    "MREG"
    "JUP"
    "TMEM154"
    "SDF2L1"
    "CENPM"
    "TNFRSF8"
    "HLA-DRB1"
    "C1orf54"
    "AUTS2"
    "ADAMTS12"
    "CASP10"
    "C8orf88"
    "MEF2B"
    "MSL3"
    "GCSAM"
    "BCL3"
    "CTTN"
    "TXNDC5"
    "CCSAP"
    "KANK2"
    "ADAM19"
    "CCNG2"
    "MBNL2"
    "S1PR2"
    "E2F7"
    "CHCHD6"
    "FYN"
    "TCTN1"
    "PRKCH"
    "LPAR6"
    "RACGAP1"
    "CTB-31O20.2"
    "RP11-903H12.5"
    "PHACTR1"
    "NREP"
    "BUB1B"
    "TRPV2"
    "DTX4"
    "HLA-DOB"
    "CFLAR"
    "RP11-279O9.4"
    "FAM81A"
    "FAM107B"
    "CIITA"
    "HIST1H2BH"
    "IRF5"
    "EPHB1"
    "MAPK13"
    "RP3-395M20.12"
    "MCM4"
    "ANG"
    "JAKMIP1"
    "RHOBTB2"
    "LINC00877"
    "MSH6"
    "CCDC34"
    "MAD2L1"
    "MELK"
    "SAMD10"
    "IL6ST"
    "LMO7"
    "LOXL3"
    "ADGRE5"
    "IL7"
    "TCF19"
    "FADS1"
    "LYSMD2"
    "IRF1"
    "DCTPP1"
    "CCPG1"
    "ARID5A"
    "NLK"
    "LCP2"
    "ZNF367"
    "PRKD3"
    "CDKN2C"
    "RP11-326C3.12"
    "CH17-373J23.1"

</pre><img vspace="5" hspace="5" src="demo_script2_01.png" alt=""> <h2 id="3">Spline-fit feature selection with single data X</h2><pre class="codeinput">[X,genelist]=sc_readfile(<span class="string">'example_data/GSM3044891_GeneExp.UMIs.10X1.txt'</span>);
[X,genelist]=sc_selectg(X,genelist,3,1);

sortit=true;
[T1]=sc_splinefit(X,genelist,sortit);
<span class="comment">% Top 50 featured genes with highest deviation (D) values</span>
T1.genes(1:50)
dofit=true;
showdata=true;
<span class="comment">% Show data points and the spline-fit curve</span>
figure;
gui.sc_scatter3genes(X,genelist,dofit,showdata);
view([36.39 46.25])
</pre><pre class="codeoutput">Reading example_data/GSM3044891_GeneExp.UMIs.10X1.txt ...... done.

ans = 

  50&times;1 string array

    "SON"
    "IGLC2"
    "HLA-E"
    "GTPBP4"
    "CYB561A3"
    "TUBA1B"
    "AASDHPPT"
    "TAP2"
    "CHD1L"
    "SEC61B"
    "ZFP90"
    "CPSF7"
    "UBR3"
    "MRPS18C"
    "TSC1"
    "TMSB4X"
    "LMO7"
    "SYNJ2BP-COX16"
    "EIF3F"
    "MRPS10"
    "CDC37L1"
    "PPP1CB"
    "GIMAP7"
    "BET1"
    "TMED4"
    "POLE3"
    "ZSCAN9"
    "MTHFD2"
    "SMYD2"
    "DOCK8"
    "ADRBK1"
    "RAB38"
    "LIPE"
    "SERF2"
    "MALAT1"
    "BRK1"
    "ARF5"
    "PIM2"
    "MRPL28"
    "TMEM64"
    "ANP32A"
    "KCNQ5"
    "SEL1L"
    "MAP2K6"
    "EIF3H"
    "SLC25A3"
    "DNLZ"
    "ZCWPW1"
    "TMEM128"
    "CHMP2B"

</pre><img vspace="5" hspace="5" src="demo_script2_02.png" alt=""> <h2 id="5">Analysis of differentially deviated (DD) genes using spline-fit feature selection with data X and Y</h2><p>Read and pre-process two data sets, X and Y</p><pre class="codeinput">[X,genelistx]=sc_readfile(<span class="string">'example_data/GSM3204304_P_P_Expr.csv'</span>);
[Y,genelisty]=sc_readfile(<span class="string">'example_data/GSM3204305_P_N_Expr.csv'</span>);
[X,genelistx]=sc_selectg(X,genelistx,3,1);
[Y,genelisty]=sc_selectg(Y,genelisty,3,1);

<span class="comment">% Show 3D scatter plot and spline-fit curve for X</span>
figure;
dofit=true;
showdata=true;
subplot(2,1,1)
gui.sc_scatter3genes(X,genelistx,dofit,showdata);
title(<span class="string">'Data 1'</span>)
view([-6.39 36.70])

<span class="comment">% Show 3D scatter plot and spline-fit curve for Y</span>
<span class="comment">%figure;</span>
subplot(2,1,2)
gui.sc_scatter3genes(Y,genelisty,dofit,showdata);
title(<span class="string">'Data 2'</span>)
<span class="comment">% view([24.08 32.68])</span>
view([-6.39 36.70])
</pre><pre class="codeoutput">Reading example_data/GSM3204304_P_P_Expr.csv ...... done.
Reading example_data/GSM3204305_P_N_Expr.csv ...... done.
</pre><img vspace="5" hspace="5" src="demo_script2_03.png" alt=""> <h2 id="7">Using function SC_SPLINEFIT2 to fit X and Y separately and obtain DD</h2><p>value for each gene.</p><pre class="codeinput">[T2]=sc_splinefit2(X,Y,genelistx,genelisty,true);
</pre><h2 id="8">Top 50 genes with highest DD value.</h2><pre class="codeinput">T2.genes(1:50)
</pre><pre class="codeoutput">
ans = 

  50&times;1 string array

    "NDUFA10"
    "ARID4A"
    "SNRPA"
    "LRRC75A"
    "IRAK1"
    "SLC7A2"
    "SDCBP2"
    "NCKAP1"
    "RPS6KB2"
    "ASCC3"
    "GNAI2"
    "NNT-AS1"
    "PIGF"
    "ZNFX1"
    "UPF3B"
    "CA9"
    "EMP2"
    "COPA"
    "CBX4"
    "EIF5A"
    "TGIF2"
    "ARF1"
    "YDJC"
    "MAPKBP1"
    "HACD1"
    "BCAS2"
    "SNAP29"
    "GJB3"
    "G6PC3"
    "MRPS5"
    "PABPC4"
    "GSTZ1"
    "APOBEC3G"
    "POLDIP3"
    "SMIM7"
    "CDC6"
    "MRPL16"
    "UNC50"
    "ARHGEF2"
    "TNRC6B"
    "MIF4GD"
    "C6orf89"
    "ZNF593"
    "ALG8"
    "ATP5G2"
    "ACP5"
    "ATP1B1"
    "CHCHD10"
    "RAB32"
    "SLC25A5"

</pre><h2 id="9">The End</h2><p class="footer"><br><a href="https://www.mathworks.com/products/matlab/">Published with MATLAB&reg; R2020b</a><br></p></div><!--
##### SOURCE BEGIN #####
%% Demonstration of Feature Selection Functions
%% HVG analysis with single data X
%%
cdgea; % set working directory
[X,genelist]=sc_readfile('example_data/GSM3044891_GeneExp.UMIs.10X1.txt');   
[X,genelist]=sc_selectg(X,genelist,3,1);
% Normalize data with DESeq method
Xn=sc_norm(X,'type','deseq');
[T]=sc_hvg(Xn,genelist,true,true);

% Highly variable genes (HVGenes), FDR<0.05
HVGenes=T.genes(T.fdr<0.05)

%% Spline-fit feature selection with single data X
%%
[X,genelist]=sc_readfile('example_data/GSM3044891_GeneExp.UMIs.10X1.txt');   
[X,genelist]=sc_selectg(X,genelist,3,1);

sortit=true;
[T1]=sc_splinefit(X,genelist,sortit);
% Top 50 featured genes with highest deviation (D) values 
T1.genes(1:50)
dofit=true;
showdata=true;
% Show data points and the spline-fit curve
figure;
gui.sc_scatter3genes(X,genelist,dofit,showdata);
view([36.39 46.25])

%% Analysis of differentially deviated (DD) genes using spline-fit feature selection with data X and Y
%%
% Read and pre-process two data sets, X and Y
[X,genelistx]=sc_readfile('example_data/GSM3204304_P_P_Expr.csv');
[Y,genelisty]=sc_readfile('example_data/GSM3204305_P_N_Expr.csv');
[X,genelistx]=sc_selectg(X,genelistx,3,1);
[Y,genelisty]=sc_selectg(Y,genelisty,3,1);

% Show 3D scatter plot and spline-fit curve for X
figure;
dofit=true;
showdata=true;
subplot(2,1,1)
gui.sc_scatter3genes(X,genelistx,dofit,showdata);
title('Data 1')
view([-6.39 36.70])

% Show 3D scatter plot and spline-fit curve for Y
%figure;
subplot(2,1,2)
gui.sc_scatter3genes(Y,genelisty,dofit,showdata);
title('Data 2')
% view([24.08 32.68])
view([-6.39 36.70])

%% Using function SC_SPLINEFIT2 to fit X and Y separately and obtain DD
% value for each gene.
[T2]=sc_splinefit2(X,Y,genelistx,genelisty,true);

%% Top 50 genes with highest DD value.
T2.genes(1:50)

%% The End
##### SOURCE END #####
--></body></html>